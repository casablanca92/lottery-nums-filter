<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
</head>
<body>
<div id="app">
    <v-app>
        <template>
            <v-container fluid>
                <v-row>
                    <v-col
                            cols="8"
                            md="6"
                    >
                        <v-textarea
                                filled outlined
                                name="input-1-1"
                                label="输入需要计算的数字"
                                hint="请修改数字"
                                v-model="message"
                        ></v-textarea>
                    </v-col>
                </v-row>
                <v-row>
                    <v-col
                            cols="8"
                            md="6"
                    >
                        <v-textarea
                                filled outlined
                                name="input-1-2"
                                label="输入需要筛选的组合(输入上方的需要计算的数字可自动生成)"
                                v-model="result"
                                hint="输入需要筛选的组合,按行排列"
                        ></v-textarea>
                        <v-btn align="center"
                               tile
                               color="success"
                               col="2"
                        >
                            数量：{{count}}
                        </v-btn>
                    </v-col>

                    <v-col>
                        <v-btn align="center"
                               tile
                               color="success"
                               v-on:click=combine()
                        >
                            <v-icon left>
                                mdi-pencil
                            </v-icon>
                            点击从上方数字生成组合
                        </v-btn>
                    </v-col>
                </v-row>
                <v-row>
                    <v-col cols="2">
                        <v-subheader>包含一个</v-subheader>
                    </v-col>
                    <v-col cols="4">
                        <v-text-field
                                label="填入数字(英文逗号(,)隔开),最少1个"
                                v-model="include1"
                                hint="01,02,03,04"
                        ></v-text-field>
                    </v-col>
                    <v-col>
                        <v-btn rounded
                               color="primary"
                               dark
                               v-on:click="filter1()"
                        >
                            <v-icon left>
                                mdi-pencil
                            </v-icon>
                            点击筛选结果
                        </v-btn>
                    </v-col>
                     <v-col
                            cols="4"
                            md="4"
                    >
                        <v-textarea
                                filled outlined
                                name="input-1-2"
                                label="输入需要筛选的组合(点击左边的按钮可自动生成)"
                                v-model="result1"
                                hint="输入需要筛选的组合,按行排列"
                        ></v-textarea>
                        <v-btn align="center"
                               tile
                               color="success"
                               col="2"
                        >
                            数量：{{count1}}
                        </v-btn>
                    </v-col>
                </v-row>

                <v-row>
                    <v-col cols="2">
                        <v-subheader>包含两个</v-subheader>
                    </v-col>
                    <v-col cols="4">
                        <v-text-field
                                label="填入数字(英文逗号(,)隔开)最少2个"
                                v-model="include2"
                                hint="01,02"
                        ></v-text-field>
                    </v-col>
                    <v-col>
                        <v-btn rounded
                               color="primary"
                               dark
                               v-on:click="filter2()"
                        >
                            <v-icon left>
                                mdi-pencil
                            </v-icon>
                            点击筛选结果
                        </v-btn>
                    </v-col>
                     <v-col
                            cols="4"
                            md="4"
                    >
                        <v-textarea
                                filled outlined
                                name="input-1-2"
                                label="输入需要筛选的组合(点击左边的按钮可自动生成)"
                                v-model="result2"
                                hint="输入需要筛选的组合,按行排列"
                        ></v-textarea>
                        <v-btn align="center"
                               tile
                               color="success"
                               col="2"
                        >
                            数量：{{count2}}
                        </v-btn>
                    </v-col>
                </v-row>

                <v-row>
                    <v-col cols="2">
                        <v-subheader>包含三个</v-subheader>
                    </v-col>
                    <v-col cols="4">
                        <v-text-field
                                label="填入数字(英文逗号(,)隔开)最少3个"
                                v-model="include3"
                                hint="01,02,03"
                        ></v-text-field>
                    </v-col>
                    <v-col>
                        <v-btn rounded
                               color="primary"
                               dark
                               v-on:click="filter3()"
                        >
                            <v-icon left>
                                mdi-pencil
                            </v-icon>
                            点击筛选结果
                        </v-btn>
                    </v-col>
                     <v-col
                            cols="4"
                            md="4"
                    >
                        <v-textarea
                                filled outlined
                                name="input-1-2"
                                label="输入需要筛选的组合(点击左边的按钮可自动生成)"
                                v-model="result3"
                                hint="输入需要筛选的组合,按行排列"
                        ></v-textarea>
                        <v-btn align="center"
                               tile
                               color="success"
                               col="2"
                        >
                            数量：{{count3}}
                        </v-btn>
                    </v-col>
                </v-row>

                <v-row>
                    <v-col cols="2">
                        <v-subheader>包含四个</v-subheader>
                    </v-col>
                    <v-col cols="4">
                        <v-text-field
                                label="填入数字(英文逗号(,)隔开)最少4个"
                                v-model="include4"
                                hint="01,02,03,04"
                        ></v-text-field>
                    </v-col>
                    <v-col>
                        <v-btn rounded
                               color="primary"
                               dark
                               v-on:click="filter4()"
                        >
                            <v-icon left>
                                mdi-pencil
                            </v-icon>
                            点击筛选结果
                        </v-btn>
                    </v-col>
                     <v-col
                            cols="4"
                            md="4"
                    >
                        <v-textarea
                                filled outlined
                                name="input-1-2"
                                label="输入需要筛选的组合(点击左边的按钮可自动生成)"
                                v-model="result4"
                                hint="输入需要筛选的组合,按行排列"
                        ></v-textarea>
                        <v-btn align="center"
                               tile
                               color="success"
                               col="2"
                        >
                            数量：{{count4}}
                        </v-btn>
                    </v-col>
                </v-row>

                 <v-row>
                    <v-col cols="2">
                        <v-subheader>求交集</v-subheader>
                    </v-col>
                
                     <v-col
                            cols="4"
                            md="4"
                    >
                        <v-textarea
                                filled outlined
                                name="intersection1-1-2"
                                label="输入需要筛选的组合(点击左边的按钮可自动生成)"
                                v-model="intersection1"
                                hint="输入需要筛选的组合,按行排列"
                        ></v-textarea>
                    </v-col>
                    <v-col
                            cols="4"
                            md="4"
                    >
                        <v-textarea
                                filled outlined
                                name="intersection2-1-2"
                                label="输入需要筛选的组合(点击左边的按钮可自动生成)"
                                v-model="intersection2"
                                hint="输入需要筛选的组合,按行排列"
                        ></v-textarea>
                    </v-col>
                </v-row>
                <v-row>
                    <v-col>
                        <v-btn rounded
                               color="primary"
                               dark
                               v-on:click="intersection()"
                        >
                            <v-icon left>
                                mdi-pencil
                            </v-icon>
                            点击求交集
                        </v-btn>
                    </v-col>
                </v-row>
                <v-row>
                    <v-col cols="2">
                        <v-subheader>结果</v-subheader>
                    </v-col>
                
                     <v-col
                            cols="4"
                            md="4"
                    >
                        <v-textarea
                                filled outlined
                                name="intersection_result"
                                label="输入需要筛选的组合(点击左边的按钮可自动生成)"
                                v-model="intersection_result"
                                hint="输入需要筛选的组合,按行排列"
                        ></v-textarea>
                    </v-col>
                    <v-btn align="center"
                               tile
                               color="success"
                               col="2"
                        >
                            数量：{{count5}}
                        </v-btn>
                </v-row>
            </v-container>
        </template>
    </v-app>
</div>

<script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
<script src="./combine.js"></script>
<script>
    new Vue({
        el: '#app',
        data: {
            message: "01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35",
            // message: "01,02,03,04,05,06",
            result: '',
            result1: '',
            result2: '',
            result3: '',
            result4: '',
            include1: '',
            include2: '',
            include3: '',
            include4: '',
            intersection1:'',
            intersection2:'',
            intersection_result:'',
            count: 0,
            count1: 0,
            count2: 0,
            count3: 0,
            count4: 0,
            count5: 0,
        },
        vuetify: new Vuetify(),
        methods: {
            combine: function () {
                // `this` 在方法里指向当前 Vue 实例
                this.result = '';
                let combineResult = this.arrayCombine(this.message.split(','), 5);
                for (var i = 0, len = combineResult.length; i < len; i++) {
                    if (i == len - 1) {
                        this.result += combineResult[i];
                    } else {
                        this.result += combineResult[i] + '\n';
                    }
                }
                this.getCount(this.result,'count');
                // this.result = this.message.split(',');
                // `event` 是原生 DOM 事件

            },
            /**
             * 获得指定数组的所有组合
             */
            arrayCombine: function (targetArr = [], count = 1) {
                if (!Array.isArray(targetArr)) return []

                const resultArrs = []
                // 所有组合的 01 排列
                const flagArrs = this.getFlagArrs(targetArr.length, count)
                while (flagArrs.length) {
                    const flagArr = flagArrs.shift()
                    resultArrs.push(targetArr.filter((_, idx) => flagArr[idx]))
                }
                return resultArrs
            },

            /**
             * 获得从 m 中取 n 的所有组合
             * 思路如下：
             * 生成一个长度为 m 的数组，
             * 数组元素的值为 1 表示其下标代表的数被选中，为 0 则没选中。
             *
             * 1. 初始化数组，前 n 个元素置 1，表示第一个组合为前 n 个数；
             * 2. 从左到右扫描数组元素值的 “10” 组合，找到第一个 “10” 组合后将其变为 “01” 组合；
             * 3. 将其左边的所有 “1” 全部移动到数组的最左端
             * 4. 当 n 个 “1” 全部移动到最右端时（没有 “10” 组合了），得到了最后一个组合。
             */
            getFlagArrs: function (m, n = 1) {
                if (n < 1 || m < n) return []

                // 先生成一个长度为 m 字符串，开头为 n 个 1， 例如“11100”
                let str = '1'.repeat(n) + '0'.repeat(m - n)
                let pos
                // 1
                const resultArrs = [Array.from(str, x => Number(x))]
                const keyStr = '10'

                while (str.indexOf(keyStr) > -1) {
                    pos = str.indexOf(keyStr)
                    // 2
                    str = str.replace(keyStr, '01')
                    // 3
                    str = Array.from(str.slice(0, pos))
                        .sort((a, b) => b - a)
                        .join('') + str.slice(pos)
                    // 4
                    resultArrs.push(Array.from(str, x => Number(x)))
                }
                return resultArrs
            },
            filter1: function () {
                let initData = this.result.split('\n');
                let type1 = this.include1.split(',');
                let del_arr = [];
                for (let i = 0, len = initData.length; i < len; i++) {
                    let res = false;
                    for (let j = 0, lens = type1.length; j < lens; j++) {
                        if (initData[i].indexOf(type1[j]) >= 0) {
                            res = true;
                        }
                    }
                    if (res == false) {
                        del_arr.push(i);
                    }
                }
                //todo 倒着删除
                del_arr.reverse();
                for (let i = 0, len = del_arr.length; i < len; i++) {
                    initData.splice(del_arr[i], 1)
                }
                this.result1 = initData.join('\n');
                this.getCount(this.result1,'count1');
            },
            filter2: function () {
                let type2 = this.include2.split(',');
                if (type2.length < 2) {
                    alert('最少需要两个数字');
                    return false;
                }

                let combie2 = this.arrayCombine(type2, 2);
                let initData = this.result.split('\n');
                // let resData = this.result.split('\n');
                let del_arr = [];
                for (let i = 0, len = initData.length; i < len; i++) {
                    // console.log(i);
                    // console.log(initData[i]);
                    let res = false;

                    for (let j = 0, lens = combie2.length; j < lens; j++) {
                        if (initData[i].indexOf(combie2[j][0]) >= 0 && initData[i].indexOf(combie2[j][1]) >= 0) {
                            res = true;
                        }
                    }
                    if (res == false) {
                        del_arr.push(i);
                    }
                }
                //todo 倒着删除
                del_arr.reverse();
                for (let i = 0, len = del_arr.length; i < len; i++) {
                    initData.splice(del_arr[i], 1)
                }
                this.result2 = initData.join('\n');
                this.getCount(this.result2,'count2');
            },
            filter3: function () {
                let type3 = this.include3.split(',');
                if (type3.length < 3) {
                    alert('最少需要三个数字');
                    return false;
                }
                let combie3 = this.arrayCombine(type3, 3);
                let initData = this.result.split('\n');
                // let resData = this.result.split('\n');
                let del_arr = [];
                for (let i = 0, len = initData.length; i < len; i++) {
                    // console.log(i);
                    // console.log(initData[i]);
                    let res = false;
                    for (let j = 0, lens = combie3.length; j < lens; j++) {
                        // console.log(combie3[j][0]);
                        // console.log(combie3[j][1]);
                        // console.log(combie3[j][2]);
                        // console.log(initData[i].indexOf(combie3[j][0]));
                        // console.log(initData[i].indexOf(combie3[j][1]));
                        // console.log(initData[i].indexOf(combie3[j][2]));
                        if (initData[i].indexOf(combie3[j][0]) >= 0 && initData[i].indexOf(combie3[j][1]) >= 0 && initData[i].indexOf(combie3[j][2]) >= 0) {
                            res = true;
                        }
                    }
                    if (res == false) {
                        del_arr.push(i);
                    }
                }
                // console.log(resData);
                del_arr.reverse();
                for (let i = 0, len = del_arr.length; i < len; i++) {
                    initData.splice(del_arr[i], 1)
                }
                this.result3 = initData.join('\n');
                this.getCount(this.result3,'count3');
            },
            filter4: function () {
                let type4 = this.include4.split(',');
                if (type4.length < 4) {
                    alert('最少需要四个数字');
                    return false;
                }
                let combie4 = this.arrayCombine(type4, 4);
                let initData = this.result.split('\n');
                // let resData = this.result.split('\n');
                let del_arr = [];
                for (let i = 0, len = initData.length; i < len; i++) {
                    // console.log(i);
                    // console.log(initData[i]);
                    let res = false;
                    for (let j = 0, lens = combie4.length; j < lens; j++) {
                        if (initData[i].indexOf(combie4[j][0]) >= 0 && initData[i].indexOf(combie4[j][1]) >= 0 && initData[i].indexOf(combie4[j][2]) >= 0 && initData[i].indexOf(combie4[j][3]) >= 0) {
                            res = true;
                        }
                    }
                    if (res == false) {
                        del_arr.push(i);
                    }
                }
                del_arr.reverse();
                for (let i = 0, len = del_arr.length; i < len; i++) {
                    initData.splice(del_arr[i], 1)
                }
                this.result4 = initData.join('\n');
                this.getCount(this.result4,'count4');
            },
            getCount: function (item,countName) {
               
                this[countName] = item.split('\n').length
            },
            intersection: function() {
               let  intersection_left = this.intersection1.split('\n');
               let  intersection_right = this.intersection2.split('\n');
               let intersection = intersection_left.filter(v => intersection_right.includes(v));
               this.intersection_result = intersection.join('\n');
               this.getCount(this.intersection_result,'count5');
            }
        }

    })
</script>
</body>
</html>
